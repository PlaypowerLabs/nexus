<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlayPower Games - The Mathverse</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        header: ['Space Grotesk', 'sans-serif'],
                    },
                    colors: {
                        deepSpace: '#050B14',
                        electricCyan: '#00F0FF',
                        solarOrange: '#FF8A00',
                        neonLime: '#39FF14',
                        voidPurple: '#1A0B2E',
                    }
                }
            }
        }
    </script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Three.js & Post Processing -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { margin: 0; overflow: hidden; background-color: #050B14; }
        canvas { display: block; position: fixed; top: 0; left: 0; z-index: 0; }
        #ui-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10; pointer-events: none; }
        .interactive { pointer-events: auto; }
        
        /* Custom Scrollbar hide */
        ::-webkit-scrollbar { display: none; }
        
        .fade-enter { opacity: 0; transform: translateY(20px); transition: all 1s ease-out; }
        .fade-enter-active { opacity: 1; transform: translateY(0); }
        .fade-exit { opacity: 1; transform: translateY(0); transition: all 0.5s ease-in; }
        .fade-exit-active { opacity: 0; transform: translateY(-20px); }

        .glass-panel {
            background: rgba(5, 11, 20, 0.6);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(0, 240, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 240, 255, 0.1);
        }

        .hologram-glow {
            text-shadow: 0 0 10px rgba(0, 240, 255, 0.7);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import * as THREE from 'three';
        import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
        import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
        import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

        const { useState, useEffect, useRef, useMemo } = React;

        // --- COMPONENTS ---

        const Nav = () => (
            <nav className="fixed top-0 left-0 w-full p-6 flex justify-between items-center z-50 pointer-events-none">
                <div className="flex items-center gap-2 interactive cursor-pointer">
                    <div className="w-8 h-8 bg-gradient-to-tr from-electricCyan to-voidPurple rounded-md flex items-center justify-center font-bold text-white">P</div>
                    <span className="text-white font-header font-bold text-xl tracking-wide">PlayPower</span>
                </div>
                <div className="hidden md:flex gap-8 text-white/70 font-sans text-sm interactive">
                    <a href="#" className="hover:text-electricCyan transition-colors">Methodology</a>
                    <a href="#" className="hover:text-electricCyan transition-colors">For Schools</a>
                    <a href="#" className="hover:text-electricCyan transition-colors">Sign In</a>
                    <button className="px-4 py-2 border border-electricCyan/50 rounded-full text-electricCyan hover:bg-electricCyan/10 transition-all">
                        Get Started
                    </button>
                </div>
            </nav>
        );

        const ScrollIndicator = () => (
            <div className="fixed bottom-10 left-1/2 -translate-x-1/2 text-white/50 flex flex-col items-center gap-2 animate-bounce z-40">
                <span className="text-xs uppercase tracking-widest">Scroll to Explore</span>
                <i data-lucide="chevron-down"></i>
            </div>
        );

        const HeroSection = ({ active }) => (
            <div className={`absolute inset-0 flex flex-col items-center justify-center text-center transition-opacity duration-1000 ${active ? 'opacity-100 pointer-events-auto' : 'opacity-0 pointer-events-none'}`}>
                <h1 className="text-5xl md:text-8xl font-header font-bold text-transparent bg-clip-text bg-gradient-to-b from-white to-electricCyan drop-shadow-[0_0_15px_rgba(0,240,255,0.5)] mb-6 tracking-tight">
                    UNLOCK THE <br/> HIDDEN LOGIC OF FUN
                </h1>
                <p className="text-xl md:text-2xl text-blue-200/80 font-light max-w-2xl mb-12">
                    A living universe of games for ages 5–14.
                </p>
                <button 
                    onClick={() => window.dispatchEvent(new CustomEvent('warp-speed'))}
                    className="interactive group relative px-12 py-4 bg-transparent overflow-hidden rounded-full cursor-pointer"
                >
                    <div className="absolute inset-0 w-full h-full bg-electricCyan/10 group-hover:bg-electricCyan/20 transition-all border border-electricCyan/50 rounded-full blur-[1px]"></div>
                    <span className="relative text-electricCyan font-bold tracking-widest group-hover:tracking-[0.2em] transition-all duration-300">
                        [ DIVE IN ]
                    </span>
                    <div className="absolute inset-0 rounded-full ring-2 ring-electricCyan/30 animate-pulse"></div>
                </button>
            </div>
        );

        const GradeBand = ({ title, age, desc, color, active, position }) => {
            const colors = {
                orange: 'text-solarOrange border-solarOrange/30 shadow-solarOrange/20',
                cyan: 'text-electricCyan border-electricCyan/30 shadow-electricCyan/20',
                purple: 'text-neonLime border-neonLime/30 shadow-neonLime/20' // Using Lime for contrast
            };

            return (
                <div 
                    className={`absolute transition-all duration-700 transform ${active ? 'opacity-100 scale-100 translate-y-0' : 'opacity-0 scale-90 translate-y-20 pointer-events-none'}`}
                    style={{ 
                        left: position === 'left' ? '10%' : 'auto', 
                        right: position === 'right' ? '10%' : 'auto',
                        top: '40%',
                        maxWidth: '400px'
                    }}
                >
                    <div className={`glass-panel p-8 rounded-2xl border ${colors[color].split(' ')[1]} shadow-[0_0_30px_rgba(0,0,0,0.5)]`}>
                        <div className={`text-xs font-bold uppercase tracking-widest mb-2 ${colors[color].split(' ')[0]}`}>{age}</div>
                        <h2 className="text-4xl font-header font-bold text-white mb-4">{title}</h2>
                        <p className="text-gray-300 leading-relaxed mb-6">{desc}</p>
                        
                        {/* Holographic Preview Mockup */}
                        <div className="relative w-full aspect-video bg-black/40 rounded-lg overflow-hidden border border-white/10 group interactive cursor-pointer">
                            <div className="absolute inset-0 flex items-center justify-center">
                                <div className={`w-12 h-12 rounded-full border-2 flex items-center justify-center ${colors[color].split(' ')[0]} ${colors[color].split(' ')[1]}`}>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                                </div>
                            </div>
                            <div className="absolute bottom-0 left-0 w-full p-3 bg-gradient-to-t from-black/80 to-transparent text-xs text-white/70">
                                PREVIEW GAME LOOP
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const TrustSection = ({ active }) => (
             <div className={`absolute inset-0 flex items-center justify-center transition-opacity duration-1000 ${active ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl w-full px-6">
                    <div className="glass-panel p-6 rounded-xl flex flex-col items-center text-center transform hover:-translate-y-2 transition-transform interactive">
                        <div className="w-16 h-16 rounded-full bg-electricCyan/10 flex items-center justify-center mb-4 text-electricCyan">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                        </div>
                        <h3 className="text-white font-bold text-lg mb-2">Kid-Safe Certified</h3>
                        <p className="text-sm text-gray-400">COPPA compliant environment with zero external tracking.</p>
                    </div>
                    <div className="glass-panel p-6 rounded-xl flex flex-col items-center text-center transform hover:-translate-y-2 transition-transform interactive">
                        <div className="w-16 h-16 rounded-full bg-solarOrange/10 flex items-center justify-center mb-4 text-solarOrange">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
                        </div>
                        <h3 className="text-white font-bold text-lg mb-2">Real Progress</h3>
                        <p className="text-sm text-gray-400">Adaptive AI adjusts difficulty to keep your child in the flow state.</p>
                    </div>
                    <div className="glass-panel p-6 rounded-xl flex flex-col items-center text-center transform hover:-translate-y-2 transition-transform interactive">
                        <div className="w-16 h-16 rounded-full bg-neonLime/10 flex items-center justify-center mb-4 text-neonLime">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="9" x2="15" y2="15"></line><line x1="15" y1="9" x2="9" y2="15"></line></svg>
                        </div>
                        <h3 className="text-white font-bold text-lg mb-2">Ad-Free Zone</h3>
                        <p className="text-sm text-gray-400">Pure learning. No interruptions, upsells, or commercials.</p>
                    </div>
                </div>
            </div>
        );

        const FooterSection = ({ active }) => (
            <div className={`absolute inset-0 flex flex-col items-center justify-center transition-all duration-1000 ${active ? 'opacity-100 pointer-events-auto' : 'opacity-0 translate-y-10 pointer-events-none'}`}>
                 <div className="text-center z-10">
                    <h2 className="text-4xl md:text-6xl font-header font-bold text-white mb-8 hologram-glow">Ready to Launch?</h2>
                    <button className="interactive px-10 py-5 bg-electricCyan text-deepSpace font-bold text-lg rounded-full hover:bg-white transition-colors shadow-[0_0_30px_rgba(0,240,255,0.4)]">
                        CREATE EXPLORER ACCOUNT
                    </button>
                    <div className="mt-8 flex gap-6 justify-center text-xs text-white/40 font-sans interactive">
                        <a href="#" className="hover:text-white">Explorer Account</a>
                        <a href="#" className="hover:text-white">Cookie Policy</a>
                        <a href="#" className="hover:text-white">Privacy</a>
                    </div>
                 </div>
            </div>
        );

        // --- MAIN APP ---

        const App = () => {
            const [scrollProgress, setScrollProgress] = useState(0);
            const [activeSection, setActiveSection] = useState('hero');
            const containerRef = useRef(null);
            
            // Refs for Three.js control
            const sceneRef = useRef(null);
            const cameraRef = useRef(null);
            const rendererRef = useRef(null);
            const composerRef = useRef(null);
            const objectsRef = useRef([]);
            const mouseRef = useRef({ x: 0, y: 0 }); // Track mouse for parallax

            // SCROLL HANDLING
            useEffect(() => {
                let currentScroll = 0;
                let targetScroll = 0;
                
                const handleWheel = (e) => {
                    targetScroll += e.deltaY * 0.05; // Sensitivity
                    targetScroll = Math.max(0, Math.min(targetScroll, 100)); // Clamp 0-100
                };

                const handleWarp = () => {
                    targetScroll = 20; // Jump start
                };

                window.addEventListener('wheel', handleWheel);
                window.addEventListener('warp-speed', handleWarp);
                
                // Animation Loop for Smooth Scroll
                const animateScroll = () => {
                    // Lerp
                    currentScroll += (targetScroll - currentScroll) * 0.08;
                    setScrollProgress(currentScroll);
                    
                    // Determine Active Section
                    if (currentScroll < 15) setActiveSection('hero');
                    else if (currentScroll < 35) setActiveSection('k2');
                    else if (currentScroll < 55) setActiveSection('35');
                    else if (currentScroll < 75) setActiveSection('68');
                    else if (currentScroll < 90) setActiveSection('trust');
                    else setActiveSection('footer');

                    // Update 3D Camera Z Position
                    if (cameraRef.current) {
                        // Map 0-100 scroll to Z 0 to -150
                        const targetZ = -(currentScroll * 1.5);
                        cameraRef.current.position.z = targetZ;
                    }
                    
                    requestAnimationFrame(animateScroll);
                };
                
                const animId = requestAnimationFrame(animateScroll);

                return () => {
                    window.removeEventListener('wheel', handleWheel);
                    window.removeEventListener('warp-speed', handleWarp);
                    cancelAnimationFrame(animId);
                };
            }, []);

            // THREE.JS INITIALIZATION
            useEffect(() => {
                if (!containerRef.current) return;

                // 1. Setup
                const scene = new THREE.Scene();
                // Add fog for depth fading
                scene.fog = new THREE.FogExp2(0x050B14, 0.015);
                sceneRef.current = scene;

                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                cameraRef.current = camera;
                
                const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); 
                renderer.toneMapping = THREE.ReinhardToneMapping;
                containerRef.current.appendChild(renderer.domElement);
                rendererRef.current = renderer;

                // 2. Post Processing (Bloom)
                const renderScene = new RenderPass(scene, camera);
                const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
                bloomPass.threshold = 0.2;
                bloomPass.strength = 1.4; // Slightly stronger glow
                bloomPass.radius = 0.5;

                const composer = new EffectComposer(renderer);
                composer.addPass(renderScene);
                composer.addPass(bloomPass);
                composerRef.current = composer;

                // 3. Lighting
                const ambientLight = new THREE.AmbientLight(0x404040, 2);
                scene.add(ambientLight);

                const pointLight = new THREE.PointLight(0x00F0FF, 3, 100);
                pointLight.position.set(0, 0, 0);
                scene.add(pointLight);

                // 4. Objects Generation
                const objects = [];

                // --- NEW: Helper for Math Textures ---
                const createMathSprite = (text, color) => {
                    const canvas = document.createElement('canvas');
                    canvas.width = 256;
                    canvas.height = 256;
                    const ctx = canvas.getContext('2d');
                    ctx.font = 'bold 140px "Space Grotesk", sans-serif';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillStyle = color === 0x00F0FF ? '#00F0FF' : color === 0xFF8A00 ? '#FF8A00' : '#39FF14';
                    ctx.shadowColor = ctx.fillStyle;
                    ctx.shadowBlur = 20;
                    ctx.fillText(text, 128, 128);

                    const texture = new THREE.CanvasTexture(canvas);
                    const material = new THREE.SpriteMaterial({ 
                        map: texture, 
                        transparent: true, 
                        opacity: 0.9,
                        blending: THREE.AdditiveBlending 
                    });
                    const sprite = new THREE.Sprite(material);
                    sprite.scale.set(3, 3, 1);
                    return sprite;
                };

                // Helper to create glowing mesh
                const createGlowingMesh = (geometry, color, x, y, z, wireframe = false) => {
                    const material = new THREE.MeshStandardMaterial({
                        color: color,
                        roughness: 0.2,
                        metalness: 0.8,
                        emissive: color,
                        emissiveIntensity: 0.8,
                        wireframe: wireframe
                    });
                    const mesh = new THREE.Mesh(geometry, material);
                    mesh.position.set(x, y, z);
                    scene.add(mesh);
                    objects.push({ 
                        mesh, 
                        rotSpeed: Math.random() * 0.02, 
                        initialY: y,
                        floatSpeed: Math.random() * 0.002 + 0.001,
                        floatOffset: Math.random() * Math.PI * 2
                    });
                    return mesh;
                }

                // --- HERO VORTEX MIX (Z: 0 to -15) ---
                const mathSymbols = ['π', '∑', '∞', '∫', '√', '42', '+', '÷', '≠', 'x²'];
                
                for(let i=0; i<40; i++) {
                    const z = -Math.random() * 20;
                    const radius = 2 + Math.random() * 6;
                    const angle = Math.random() * Math.PI * 2;
                    const x = Math.cos(angle) * radius;
                    const y = Math.sin(angle) * radius;
                    
                    // 30% chance of being a Math Sprite
                    if (Math.random() > 0.7) {
                        const symbol = mathSymbols[Math.floor(Math.random() * mathSymbols.length)];
                        const sprite = createMathSprite(symbol, 0x00F0FF);
                        sprite.position.set(x, y, z);
                        scene.add(sprite);
                        objects.push({
                            mesh: sprite,
                            rotSpeed: 0, // Sprites always face camera, no rotation needed usually, but we can wobble them
                            initialY: y,
                            floatSpeed: Math.random() * 0.002,
                            floatOffset: Math.random() * 10
                        });
                    } else {
                        // Regular Geometry
                        const isWireframe = Math.random() > 0.5; // 50% wireframe for "blueprint" look
                        const geo = i % 2 === 0 ? new THREE.IcosahedronGeometry(Math.random() * 0.5) : new THREE.TorusGeometry(0.3, 0.1, 8, 20);
                        createGlowingMesh(geo, 0x00F0FF, x, y, z, isWireframe);
                    }
                }

                // --- K-2 SECTION (Z: -30) ---
                // Add floating Numbers (1, 2, 3) around spheres
                for(let i=0; i<8; i++) {
                    const geo = new THREE.SphereGeometry(Math.random() * 1 + 0.5, 32, 32);
                    createGlowingMesh(geo, 0xFF8A00, (Math.random()-0.5)*10 + 5, (Math.random()-0.5)*6, -35 + Math.random()*5);
                }
                // Add K-2 Math Sprites
                ['1', '2', '3', 'A', 'B'].forEach((sym, i) => {
                     const sprite = createMathSprite(sym, 0xFF8A00);
                     sprite.position.set((Math.random()-0.5)*10 + 5, (Math.random()-0.5)*8, -35 + Math.random()*5);
                     scene.add(sprite);
                     objects.push({ mesh: sprite, rotSpeed: 0, initialY: sprite.position.y, floatSpeed: 0.002, floatOffset: i });
                });

                // --- 3-5 SECTION (Z: -60) ---
                // Structured geometry
                for(let i=0; i<8; i++) {
                    const geo = new THREE.ConeGeometry(0.8, 1.5, 4);
                    createGlowingMesh(geo, 0x00F0FF, (Math.random()-0.5)*10 - 5, (Math.random()-0.5)*6, -65 + Math.random()*5, true); // Wireframe cones
                }
                // Add 3-5 Math Sprites
                ['¼', '×', '90°', '%'].forEach((sym, i) => {
                     const sprite = createMathSprite(sym, 0x00F0FF);
                     sprite.position.set((Math.random()-0.5)*10 - 5, (Math.random()-0.5)*8, -65 + Math.random()*5);
                     scene.add(sprite);
                     objects.push({ mesh: sprite, rotSpeed: 0, initialY: sprite.position.y, floatSpeed: 0.002, floatOffset: i });
                });

                // --- 6-8 SECTION (Z: -90) ---
                // Complex fractals
                for(let i=0; i<8; i++) {
                    const geo = new THREE.IcosahedronGeometry(1, 1); 
                    createGlowingMesh(geo, 0x39FF14, (Math.random()-0.5)*10 + 5, (Math.random()-0.5)*6, -95 + Math.random()*5, true);
                }
                 // Add 6-8 Math Sprites
                ['f(x)', 'y', 'z', '√'].forEach((sym, i) => {
                     const sprite = createMathSprite(sym, 0x39FF14);
                     sprite.position.set((Math.random()-0.5)*10 + 5, (Math.random()-0.5)*8, -95 + Math.random()*5);
                     scene.add(sprite);
                     objects.push({ mesh: sprite, rotSpeed: 0, initialY: sprite.position.y, floatSpeed: 0.002, floatOffset: i });
                });
                
                // --- TUNNEL PARTICLES ---
                const particlesGeo = new THREE.BufferGeometry();
                const particlesCount = 2000;
                const posArray = new Float32Array(particlesCount * 3);
                
                for(let i = 0; i < particlesCount * 3; i+=3) {
                    posArray[i] = (Math.random() - 0.5) * 50;   // x
                    posArray[i+1] = (Math.random() - 0.5) * 50; // y
                    posArray[i+2] = (Math.random() - 0.5) * 200; // z (long tunnel)
                }
                
                particlesGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
                const particlesMat = new THREE.PointsMaterial({
                    size: 0.05,
                    color: 0xffffff,
                    transparent: true,
                    opacity: 0.6
                });
                const particlesMesh = new THREE.Points(particlesGeo, particlesMat);
                scene.add(particlesMesh);
                
                // --- GATEWAY ARCH (Z: -140) ---
                const archGeo = new THREE.TorusGeometry(10, 0.5, 16, 100, Math.PI);
                const archMat = new THREE.MeshStandardMaterial({ color: 0x00F0FF, emissive: 0x00F0FF, emissiveIntensity: 2 });
                const arch = new THREE.Mesh(archGeo, archMat);
                arch.position.set(0, -5, -140);
                scene.add(arch);


                // 5. Animation Loop
                const animate = () => {
                    requestAnimationFrame(animate);
                    const time = Date.now() * 0.001;
                    
                    // Rotate and Float objects
                    objects.forEach(obj => {
                        // Rotation
                        if(obj.mesh.type === 'Mesh') {
                             obj.mesh.rotation.x += obj.rotSpeed;
                             obj.mesh.rotation.y += obj.rotSpeed;
                             
                             // Pulse Glow
                             obj.mesh.material.emissiveIntensity = 0.8 + Math.sin(time * 2 + obj.floatOffset) * 0.4;
                        } else if (obj.mesh.type === 'Sprite') {
                             // Gentle wobble for sprites
                             obj.mesh.material.rotation = Math.sin(time + obj.floatOffset) * 0.1;
                        }

                        // Floating Y movement
                        obj.mesh.position.y = obj.initialY + Math.sin(time + obj.floatOffset) * 0.5;
                    });
                    
                    // Parallax Camera Movement
                    // Smoothly interpolate current mouse offset to target
                    const targetX = (mouseRef.current.x * 2); 
                    const targetY = (mouseRef.current.y * 2);
                    camera.position.x += (targetX - camera.position.x) * 0.05;
                    camera.position.y += (targetY - camera.position.y) * 0.05;

                    // Light follows camera
                    pointLight.position.set(camera.position.x, camera.position.y, camera.position.z - 5);

                    composer.render();
                };
                
                animate();
                objectsRef.current = objects;

                // Handle Resize
                const handleResize = () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    composer.setSize(window.innerWidth, window.innerHeight);
                };

                // Handle Mouse Move for Parallax
                const handleMouseMove = (e) => {
                    // Normalize mouse pos from -1 to 1
                    mouseRef.current = {
                        x: (e.clientX / window.innerWidth) * 2 - 1,
                        y: -(e.clientY / window.innerHeight) * 2 + 1
                    };
                };

                window.addEventListener('resize', handleResize);
                window.addEventListener('mousemove', handleMouseMove);

                return () => {
                    window.removeEventListener('resize', handleResize);
                    window.removeEventListener('mousemove', handleMouseMove);
                    containerRef.current.removeChild(renderer.domElement);
                }
            }, []);

            return (
                <>
                    <Nav />
                    
                    {/* 3D Canvas Container */}
                    <div ref={containerRef} className="fixed inset-0 z-0 bg-deepSpace" />
                    
                    {/* UI Overlay Layer */}
                    <div id="ui-layer" className="z-10 text-white font-sans">
                        
                        {/* Section 1: Hero */}
                        <HeroSection active={activeSection === 'hero'} />

                        {/* Section 2: K-2 */}
                        <GradeBand 
                            title="The Playground" 
                            age="Grades K-2" 
                            desc="Soft shapes and friendly logic puzzles introduce number sense without the tears."
                            color="orange"
                            active={activeSection === 'k2'}
                            position="left"
                        />
                        
                        {/* Section 3: 3-5 */}
                        <GradeBand 
                            title="The Builders" 
                            age="Grades 3-5" 
                            desc="Constructing gears, fractions, and multiplication bridges in a structured sandbox."
                            color="cyan"
                            active={activeSection === '35'}
                            position="right"
                        />
                        
                        {/* Section 4: 6-8 */}
                        <GradeBand 
                            title="The Fractal Void" 
                            age="Grades 6-8" 
                            desc="Complex algebra and geometry visualized as breathtaking crystalline networks."
                            color="purple"
                            active={activeSection === '68'}
                            position="left"
                        />
                        
                        {/* Section 5: Trust */}
                        <TrustSection active={activeSection === 'trust'} />
                        
                        {/* Section 6: Footer */}
                        <FooterSection active={activeSection === 'footer'} />
                        
                    </div>
                    
                    <ScrollIndicator />
                    
                    {/* Progress Bar */}
                    <div className="fixed bottom-0 left-0 h-1 bg-electricCyan z-50 transition-all duration-100 ease-out" style={{ width: `${scrollProgress}%` }}></div>
                </>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>